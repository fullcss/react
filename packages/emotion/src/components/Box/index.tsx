import { ComponentPropsWithRef, ElementType, forwardRef, useContext } from 'react'
import { BoxComponentType, BoxProps } from '@jsxcss/core'
import { MediaQueryContext } from '../../contexts'
import { box } from '../../utils'

const createBox = (): BoxComponentType =>
  forwardRef(function Box<T extends ElementType>(props: BoxProps<T>, ref: ComponentPropsWithRef<T>['ref']) {
    const mediaQuery = useContext(MediaQueryContext)

    const {
      as = 'div',
      accentColor,
      alignContent,
      alignItems,
      alignSelf,
      alignTracks,
      alignmentBaseline,
      all,
      animation,
      animationComposition,
      animationDelay,
      animationDirection,
      animationDuration,
      animationFillMode,
      animationIterationCount,
      animationName,
      animationPlayState,
      animationTimeline,
      animationTimingFunction,
      appearance,
      aspectRatio,
      backdropFilter,
      backfaceVisibility,
      background,
      backgroundAttachment,
      backgroundBlendMode,
      backgroundClip,
      backgroundColor,
      backgroundImage,
      backgroundOrigin,
      backgroundPosition,
      backgroundPositionX,
      backgroundPositionY,
      backgroundRepeat,
      backgroundSize,
      baselineShift,
      blockOverflow,
      blockSize,
      border,
      borderBlock,
      borderBlockColor,
      borderBlockEnd,
      borderBlockEndColor,
      borderBlockEndStyle,
      borderBlockEndWidth,
      borderBlockStart,
      borderBlockStartColor,
      borderBlockStartStyle,
      borderBlockStartWidth,
      borderBlockStyle,
      borderBlockWidth,
      borderBottom,
      borderBottomColor,
      borderBottomLeftRadius,
      borderBottomRightRadius,
      borderBottomStyle,
      borderBottomWidth,
      borderCollapse,
      borderColor,
      borderEndEndRadius,
      borderEndStartRadius,
      borderImage,
      borderImageOutset,
      borderImageRepeat,
      borderImageSlice,
      borderImageSource,
      borderImageWidth,
      borderInline,
      borderInlineColor,
      borderInlineEnd,
      borderInlineEndColor,
      borderInlineEndStyle,
      borderInlineEndWidth,
      borderInlineStart,
      borderInlineStartColor,
      borderInlineStartStyle,
      borderInlineStartWidth,
      borderInlineStyle,
      borderInlineWidth,
      borderLeft,
      borderLeftColor,
      borderLeftStyle,
      borderLeftWidth,
      borderRadius,
      borderRight,
      borderRightColor,
      borderRightStyle,
      borderRightWidth,
      borderSpacing,
      borderStartEndRadius,
      borderStartStartRadius,
      borderStyle,
      borderTop,
      borderTopColor,
      borderTopLeftRadius,
      borderTopRightRadius,
      borderTopStyle,
      borderTopWidth,
      borderWidth,
      bottom,
      boxDecorationBreak,
      boxShadow,
      boxSizing,
      breakAfter,
      breakBefore,
      breakInside,
      captionSide,
      caretColor,
      clear,
      clipPath,
      clipRule,
      color,
      colorAdjust,
      colorInterpolation,
      colorRendering,
      colorScheme,
      columnCount,
      columnFill,
      columnGap,
      columnRule,
      columnRuleColor,
      columnRuleStyle,
      columnRuleWidth,
      columnSpan,
      columnWidth,
      columns,
      contain,
      content,
      contentVisibility,
      counterIncrement,
      counterReset,
      counterSet,
      cursor,
      display,
      dominantBaseline,
      emptyCells,
      fill,
      fillOpacity,
      fillRule,
      filter,
      flex,
      flexBasis,
      flexDirection,
      flexFlow,
      flexGrow,
      flexShrink,
      flexWrap,
      float,
      floodColor,
      floodOpacity,
      font,
      fontFamily,
      fontFeatureSettings,
      fontKerning,
      fontLanguageOverride,
      fontOpticalSizing,
      fontSize,
      fontSizeAdjust,
      fontSmooth,
      fontStretch,
      fontStyle,
      fontSynthesis,
      fontVariant,
      fontVariantAlternates,
      fontVariantCaps,
      fontVariantEastAsian,
      fontVariantLigatures,
      fontVariantNumeric,
      fontVariantPosition,
      fontVariationSettings,
      fontWeight,
      forcedColorAdjust,
      gap,
      glyphOrientationVertical,
      grid,
      gridArea,
      gridAutoColumns,
      gridAutoFlow,
      gridAutoRows,
      gridColumn,
      gridColumnEnd,
      gridColumnStart,
      gridRow,
      gridRowEnd,
      gridRowStart,
      gridTemplate,
      gridTemplateAreas,
      gridTemplateColumns,
      gridTemplateRows,
      hangingPunctuation,
      height,
      hyphenateCharacter,
      hyphens,
      imageOrientation,
      imageRendering,
      imageResolution,
      initialLetter,
      inlineSize,
      inputSecurity,
      inset,
      insetBlock,
      insetBlockEnd,
      insetBlockStart,
      insetInline,
      insetInlineEnd,
      insetInlineStart,
      isolation,
      justifyContent,
      justifyItems,
      justifySelf,
      justifyTracks,
      left,
      letterSpacing,
      lightingColor,
      lineBreak,
      lineClamp,
      lineHeight,
      lineHeightStep,
      listStyle,
      listStyleImage,
      listStylePosition,
      listStyleType,
      margin,
      marginBlock,
      marginBlockEnd,
      marginBlockStart,
      marginBottom,
      marginInline,
      marginInlineEnd,
      marginInlineStart,
      marginLeft,
      marginRight,
      marginTop,
      marker,
      markerEnd,
      markerMid,
      markerStart,
      mask,
      maskBorder,
      maskBorderMode,
      maskBorderOutset,
      maskBorderRepeat,
      maskBorderSlice,
      maskBorderSource,
      maskBorderWidth,
      maskClip,
      maskComposite,
      maskImage,
      maskMode,
      maskOrigin,
      maskPosition,
      maskRepeat,
      maskSize,
      maskType,
      mathDepth,
      mathShift,
      mathStyle,
      maxBlockSize,
      maxHeight,
      maxInlineSize,
      maxLines,
      maxWidth,
      minBlockSize,
      minHeight,
      minInlineSize,
      minWidth,
      mixBlendMode,
      motion,
      motionDistance,
      motionPath,
      motionRotation,
      objectFit,
      objectPosition,
      offset,
      offsetAnchor,
      offsetDistance,
      offsetPath,
      offsetRotate,
      offsetRotation,
      opacity,
      order,
      orphans,
      outline,
      outlineColor,
      outlineOffset,
      outlineStyle,
      outlineWidth,
      overflow,
      overflowAnchor,
      overflowBlock,
      overflowClipBox,
      overflowClipMargin,
      overflowInline,
      overflowWrap,
      overflowX,
      overflowY,
      overscrollBehavior,
      overscrollBehaviorBlock,
      overscrollBehaviorInline,
      overscrollBehaviorX,
      overscrollBehaviorY,
      padding,
      paddingBlock,
      paddingBlockEnd,
      paddingBlockStart,
      paddingBottom,
      paddingInline,
      paddingInlineEnd,
      paddingInlineStart,
      paddingLeft,
      paddingRight,
      paddingTop,
      pageBreakAfter,
      pageBreakBefore,
      pageBreakInside,
      paintOrder,
      perspective,
      perspectiveOrigin,
      placeContent,
      placeItems,
      placeSelf,
      pointerEvents,
      position,
      printColorAdjust,
      quotes,
      resize,
      right,
      rotate,
      rowGap,
      rubyAlign,
      rubyMerge,
      rubyPosition,
      scale,
      scrollBehavior,
      scrollMargin,
      scrollMarginBlock,
      scrollMarginBlockEnd,
      scrollMarginBlockStart,
      scrollMarginBottom,
      scrollMarginInline,
      scrollMarginInlineEnd,
      scrollMarginInlineStart,
      scrollMarginLeft,
      scrollMarginRight,
      scrollMarginTop,
      scrollPadding,
      scrollPaddingBlock,
      scrollPaddingBlockEnd,
      scrollPaddingBlockStart,
      scrollPaddingBottom,
      scrollPaddingInline,
      scrollPaddingInlineEnd,
      scrollPaddingInlineStart,
      scrollPaddingLeft,
      scrollPaddingRight,
      scrollPaddingTop,
      scrollSnapAlign,
      scrollSnapMargin,
      scrollSnapMarginBottom,
      scrollSnapMarginLeft,
      scrollSnapMarginRight,
      scrollSnapMarginTop,
      scrollSnapStop,
      scrollSnapType,
      scrollbarColor,
      scrollbarGutter,
      scrollbarWidth,
      shapeImageThreshold,
      shapeMargin,
      shapeOutside,
      shapeRendering,
      stopColor,
      stopOpacity,
      stroke,
      strokeDasharray,
      strokeDashoffset,
      strokeLinecap,
      strokeLinejoin,
      strokeMiterlimit,
      strokeOpacity,
      strokeWidth,
      tabSize,
      tableLayout,
      textAlign,
      textAlignLast,
      textAnchor,
      textCombineUpright,
      textDecoration,
      textDecorationColor,
      textDecorationLine,
      textDecorationSkip,
      textDecorationSkipInk,
      textDecorationStyle,
      textDecorationThickness,
      textEmphasis,
      textEmphasisColor,
      textEmphasisPosition,
      textEmphasisStyle,
      textIndent,
      textJustify,
      textOrientation,
      textOverflow,
      textRendering,
      textShadow,
      textSizeAdjust,
      textTransform,
      textUnderlineOffset,
      textUnderlinePosition,
      top,
      touchAction,
      transform,
      transformBox,
      transformOrigin,
      transformStyle,
      transition,
      transitionDelay,
      transitionDuration,
      transitionProperty,
      transitionTimingFunction,
      translate,
      unicodeBidi,
      userSelect,
      vectorEffect,
      verticalAlign,
      visibility,
      whiteSpace,
      widows,
      width,
      willChange,
      wordBreak,
      wordSpacing,
      wordWrap,
      writingMode,
      zIndex,
      zoom,
      ...rest
    } = props
    const Component = as

    return (
      <Component
        ref={ref}
        css={box(
          {
            accentColor,
            alignContent,
            alignItems,
            alignSelf,
            alignTracks,
            alignmentBaseline,
            all,
            animation,
            animationComposition,
            animationDelay,
            animationDirection,
            animationDuration,
            animationFillMode,
            animationIterationCount,
            animationName,
            animationPlayState,
            animationTimeline,
            animationTimingFunction,
            appearance,
            aspectRatio,
            backdropFilter,
            backfaceVisibility,
            background,
            backgroundAttachment,
            backgroundBlendMode,
            backgroundClip,
            backgroundColor,
            backgroundImage,
            backgroundOrigin,
            backgroundPosition,
            backgroundPositionX,
            backgroundPositionY,
            backgroundRepeat,
            backgroundSize,
            baselineShift,
            blockOverflow,
            blockSize,
            border,
            borderBlock,
            borderBlockColor,
            borderBlockEnd,
            borderBlockEndColor,
            borderBlockEndStyle,
            borderBlockEndWidth,
            borderBlockStart,
            borderBlockStartColor,
            borderBlockStartStyle,
            borderBlockStartWidth,
            borderBlockStyle,
            borderBlockWidth,
            borderBottom,
            borderBottomColor,
            borderBottomLeftRadius,
            borderBottomRightRadius,
            borderBottomStyle,
            borderBottomWidth,
            borderCollapse,
            borderColor,
            borderEndEndRadius,
            borderEndStartRadius,
            borderImage,
            borderImageOutset,
            borderImageRepeat,
            borderImageSlice,
            borderImageSource,
            borderImageWidth,
            borderInline,
            borderInlineColor,
            borderInlineEnd,
            borderInlineEndColor,
            borderInlineEndStyle,
            borderInlineEndWidth,
            borderInlineStart,
            borderInlineStartColor,
            borderInlineStartStyle,
            borderInlineStartWidth,
            borderInlineStyle,
            borderInlineWidth,
            borderLeft,
            borderLeftColor,
            borderLeftStyle,
            borderLeftWidth,
            borderRadius,
            borderRight,
            borderRightColor,
            borderRightStyle,
            borderRightWidth,
            borderSpacing,
            borderStartEndRadius,
            borderStartStartRadius,
            borderStyle,
            borderTop,
            borderTopColor,
            borderTopLeftRadius,
            borderTopRightRadius,
            borderTopStyle,
            borderTopWidth,
            borderWidth,
            bottom,
            boxDecorationBreak,
            boxShadow,
            boxSizing,
            breakAfter,
            breakBefore,
            breakInside,
            captionSide,
            caretColor,
            clear,
            clipPath,
            clipRule,
            color,
            colorAdjust,
            colorInterpolation,
            colorRendering,
            colorScheme,
            columnCount,
            columnFill,
            columnGap,
            columnRule,
            columnRuleColor,
            columnRuleStyle,
            columnRuleWidth,
            columnSpan,
            columnWidth,
            columns,
            contain,
            content,
            contentVisibility,
            counterIncrement,
            counterReset,
            counterSet,
            cursor,
            display,
            dominantBaseline,
            emptyCells,
            fill,
            fillOpacity,
            fillRule,
            filter,
            flex,
            flexBasis,
            flexDirection,
            flexFlow,
            flexGrow,
            flexShrink,
            flexWrap,
            float,
            floodColor,
            floodOpacity,
            font,
            fontFamily,
            fontFeatureSettings,
            fontKerning,
            fontLanguageOverride,
            fontOpticalSizing,
            fontSize,
            fontSizeAdjust,
            fontSmooth,
            fontStretch,
            fontStyle,
            fontSynthesis,
            fontVariant,
            fontVariantAlternates,
            fontVariantCaps,
            fontVariantEastAsian,
            fontVariantLigatures,
            fontVariantNumeric,
            fontVariantPosition,
            fontVariationSettings,
            fontWeight,
            forcedColorAdjust,
            gap,
            glyphOrientationVertical,
            grid,
            gridArea,
            gridAutoColumns,
            gridAutoFlow,
            gridAutoRows,
            gridColumn,
            gridColumnEnd,
            gridColumnStart,
            gridRow,
            gridRowEnd,
            gridRowStart,
            gridTemplate,
            gridTemplateAreas,
            gridTemplateColumns,
            gridTemplateRows,
            hangingPunctuation,
            height,
            hyphenateCharacter,
            hyphens,
            imageOrientation,
            imageRendering,
            imageResolution,
            initialLetter,
            inlineSize,
            inputSecurity,
            inset,
            insetBlock,
            insetBlockEnd,
            insetBlockStart,
            insetInline,
            insetInlineEnd,
            insetInlineStart,
            isolation,
            justifyContent,
            justifyItems,
            justifySelf,
            justifyTracks,
            left,
            letterSpacing,
            lightingColor,
            lineBreak,
            lineClamp,
            lineHeight,
            lineHeightStep,
            listStyle,
            listStyleImage,
            listStylePosition,
            listStyleType,
            margin,
            marginBlock,
            marginBlockEnd,
            marginBlockStart,
            marginBottom,
            marginInline,
            marginInlineEnd,
            marginInlineStart,
            marginLeft,
            marginRight,
            marginTop,
            marker,
            markerEnd,
            markerMid,
            markerStart,
            mask,
            maskBorder,
            maskBorderMode,
            maskBorderOutset,
            maskBorderRepeat,
            maskBorderSlice,
            maskBorderSource,
            maskBorderWidth,
            maskClip,
            maskComposite,
            maskImage,
            maskMode,
            maskOrigin,
            maskPosition,
            maskRepeat,
            maskSize,
            maskType,
            mathDepth,
            mathShift,
            mathStyle,
            maxBlockSize,
            maxHeight,
            maxInlineSize,
            maxLines,
            maxWidth,
            minBlockSize,
            minHeight,
            minInlineSize,
            minWidth,
            mixBlendMode,
            motion,
            motionDistance,
            motionPath,
            motionRotation,
            objectFit,
            objectPosition,
            offset,
            offsetAnchor,
            offsetDistance,
            offsetPath,
            offsetRotate,
            offsetRotation,
            opacity,
            order,
            orphans,
            outline,
            outlineColor,
            outlineOffset,
            outlineStyle,
            outlineWidth,
            overflow,
            overflowAnchor,
            overflowBlock,
            overflowClipBox,
            overflowClipMargin,
            overflowInline,
            overflowWrap,
            overflowX,
            overflowY,
            overscrollBehavior,
            overscrollBehaviorBlock,
            overscrollBehaviorInline,
            overscrollBehaviorX,
            overscrollBehaviorY,
            padding,
            paddingBlock,
            paddingBlockEnd,
            paddingBlockStart,
            paddingBottom,
            paddingInline,
            paddingInlineEnd,
            paddingInlineStart,
            paddingLeft,
            paddingRight,
            paddingTop,
            pageBreakAfter,
            pageBreakBefore,
            pageBreakInside,
            paintOrder,
            perspective,
            perspectiveOrigin,
            placeContent,
            placeItems,
            placeSelf,
            pointerEvents,
            position,
            printColorAdjust,
            quotes,
            resize,
            right,
            rotate,
            rowGap,
            rubyAlign,
            rubyMerge,
            rubyPosition,
            scale,
            scrollBehavior,
            scrollMargin,
            scrollMarginBlock,
            scrollMarginBlockEnd,
            scrollMarginBlockStart,
            scrollMarginBottom,
            scrollMarginInline,
            scrollMarginInlineEnd,
            scrollMarginInlineStart,
            scrollMarginLeft,
            scrollMarginRight,
            scrollMarginTop,
            scrollPadding,
            scrollPaddingBlock,
            scrollPaddingBlockEnd,
            scrollPaddingBlockStart,
            scrollPaddingBottom,
            scrollPaddingInline,
            scrollPaddingInlineEnd,
            scrollPaddingInlineStart,
            scrollPaddingLeft,
            scrollPaddingRight,
            scrollPaddingTop,
            scrollSnapAlign,
            scrollSnapMargin,
            scrollSnapMarginBottom,
            scrollSnapMarginLeft,
            scrollSnapMarginRight,
            scrollSnapMarginTop,
            scrollSnapStop,
            scrollSnapType,
            scrollbarColor,
            scrollbarGutter,
            scrollbarWidth,
            shapeImageThreshold,
            shapeMargin,
            shapeOutside,
            shapeRendering,
            stopColor,
            stopOpacity,
            stroke,
            strokeDasharray,
            strokeDashoffset,
            strokeLinecap,
            strokeLinejoin,
            strokeMiterlimit,
            strokeOpacity,
            strokeWidth,
            tabSize,
            tableLayout,
            textAlign,
            textAlignLast,
            textAnchor,
            textCombineUpright,
            textDecoration,
            textDecorationColor,
            textDecorationLine,
            textDecorationSkip,
            textDecorationSkipInk,
            textDecorationStyle,
            textDecorationThickness,
            textEmphasis,
            textEmphasisColor,
            textEmphasisPosition,
            textEmphasisStyle,
            textIndent,
            textJustify,
            textOrientation,
            textOverflow,
            textRendering,
            textShadow,
            textSizeAdjust,
            textTransform,
            textUnderlineOffset,
            textUnderlinePosition,
            top,
            touchAction,
            transform,
            transformBox,
            transformOrigin,
            transformStyle,
            transition,
            transitionDelay,
            transitionDuration,
            transitionProperty,
            transitionTimingFunction,
            translate,
            unicodeBidi,
            userSelect,
            vectorEffect,
            verticalAlign,
            visibility,
            whiteSpace,
            widows,
            width,
            willChange,
            wordBreak,
            wordSpacing,
            wordWrap,
            writingMode,
            zIndex,
            zoom,
          },
          mediaQuery
        )}
        {...rest}
      />
    )
  })

type BoxType = BoxComponentType

export const Box = createBox() as BoxType
